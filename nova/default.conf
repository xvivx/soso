server {
    listen       80;
    listen  [::]:80;
    server_name  localhost;

    access_log  /logs/host.access.log  main;
    
    real_ip_header X-Forwarded-For;
    set_real_ip_from 10.63.0.0/16;
    set_real_ip_from 172.31.0.0/16;
    real_ip_recursive on;

    location ~* trading\.js$ {
        root /usr/share/nginx/html;
        try_files $uri =404;
        
        # 设置特定的缓存头
        add_header Cache-Control "max-age=120";
        # 移除可能冲突的通用头部
        expires off;
    }

    # 处理静态资源 - 如果文件不存在则返回404
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|json|xml|txt|pdf|mp4|webm|ogg|mp3|wav|flac|aac|woff|woff2|eot|ttf|otf)$ {
        root /usr/share/nginx/html;
        try_files $uri =404;
        
        # 设置缓存头（可选）
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 处理所有其他请求 - 回退到index.html用于SPA路由
    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
        try_files $uri $uri/ /index.html;
    }

    error_page  404              /404.html;
    location = /404.html {
        root   /usr/share/nginx/html;
        internal;
    }

    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}